"use strict";(globalThis.webpackChunkdocusaurus=globalThis.webpackChunkdocusaurus||[]).push([[202],{33(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/imageb-769e9bf5e7ce19cef8e0ef1b79f6eb1e.png"},169(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/1.2-9656d9dfa276fa06f12ffd0990a2a27f.png"},198(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/1.5-1888e02be690e6021e0ee8d49aa08c7b.png"},861(e,n,i){i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"Terraform CICD and Testing on AWS/README","title":"Hands-On: Implementing Terraform CI/CD Pipelines and Security Testing on AWS","description":"Focus: Infrastructure as Code, CI/CD Automation, Security Scanning, and Testing","source":"@site/docs/Terraform CICD and Testing on AWS/README.md","sourceDirName":"Terraform CICD and Testing on AWS","slug":"/Terraform CICD and Testing on AWS/","permalink":"/Cloud-Learning-Labs/docs/Terraform CICD and Testing on AWS/","draft":false,"unlisted":false,"editUrl":"https://github.com/HoangBaoPhuoc/Cloud-Learning-Labs/tree/main/packages/create-docusaurus/templates/shared/docs/Terraform CICD and Testing on AWS/README.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Migrating to Zero Trust Architecture","permalink":"/Cloud-Learning-Labs/docs/Migrating to Zero Trust Architecture on AWS/"}}');var r=i(4848),t=i(8453);const l={},a="Hands-On: Implementing Terraform CI/CD Pipelines and Security Testing on AWS",o={},c=[{value:"Overview",id:"overview",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Workshop Scenario",id:"workshop-scenario",level:2},{value:"Task 1: Environment Setup and IDE Configuration",id:"task-1-environment-setup-and-ide-configuration",level:2},{value:"Objective",id:"objective",level:3},{value:"Steps",id:"steps",level:3},{value:"1.1 AWS Account &amp; Region Selection",id:"11-aws-account--region-selection",level:4},{value:"1.2 CloudFormation Stack Creation",id:"12-cloudformation-stack-creation",level:4},{value:"1.3 Docker Installation on Ubuntu 22.04",id:"13-docker-installation-on-ubuntu-2204",level:4},{value:"1.4 Verify Tooling",id:"14-verify-tooling",level:4},{value:"1.5 IDE Extensions",id:"15-ide-extensions",level:4},{value:"1.6 Configure IDE and Clone Repository",id:"16-configure-ide-and-clone-repository",level:4},{value:"Task 2: Local Terraform Module Development and Testing",id:"task-2-local-terraform-module-development-and-testing",level:2},{value:"Objective",id:"objective-1",level:3},{value:"2.1: Create Terraform Module",id:"21-create-terraform-module",level:3},{value:"Overview",id:"overview-1",level:4},{value:"Module Structure",id:"module-structure",level:4},{value:"2.2: Terraform Test Framework",id:"22-terraform-test-framework",level:3},{value:"Overview",id:"overview-2",level:4},{value:"Test Implementation",id:"test-implementation",level:4},{value:"2.3: Security Scanning with Checkov",id:"23-security-scanning-with-checkov",level:3},{value:"Overview",id:"overview-3",level:4},{value:"Checkov Implementation",id:"checkov-implementation",level:4},{value:"Task 3: CI/CD Pipeline Implementation",id:"task-3-cicd-pipeline-implementation",level:2},{value:"Objective",id:"objective-2",level:3},{value:"3.1 Pipeline Architecture",id:"31-pipeline-architecture",level:3},{value:"Terraform Module Validation Pipeline",id:"terraform-module-validation-pipeline",level:4},{value:"Terraform Deployment Pipeline",id:"terraform-deployment-pipeline",level:4},{value:"3.2 Resources Overview",id:"32-resources-overview",level:3},{value:"Pipelines &amp; Build Projects",id:"pipelines--build-projects",level:4},{value:"3.3 Understanding Git-Remote-S3",id:"33-understanding-git-remote-s3",level:3},{value:"3.4 Deploy Infrastructure",id:"34-deploy-infrastructure",level:3},{value:"Step 1: Navigate to Directory",id:"step-1-navigate-to-directory",level:4},{value:"Step 2: Create Configuration Files",id:"step-2-create-configuration-files",level:4},{value:"Step 3: Verify and Deploy Resources",id:"step-3-verify-and-deploy-resources",level:4},{value:"Step 4: Save Outputs",id:"step-4-save-outputs",level:4},{value:"Step 6: Check CodePipeline (Expected Error)",id:"step-6-check-codepipeline-expected-error",level:4},{value:"3.5 Configure S3 Remote Backend",id:"35-configure-s3-remote-backend",level:3},{value:"Why Remote State?",id:"why-remote-state",level:4},{value:"Step 1: Edit provider.tf",id:"step-1-edit-providertf",level:4},{value:"Step 2: Update Bucket Name",id:"step-2-update-bucket-name",level:4},{value:"Step 3: Migrate State",id:"step-3-migrate-state",level:4},{value:"Step 4: Verify in S3",id:"step-4-verify-in-s3",level:4},{value:"3.6 Trigger Module Validation Pipeline",id:"36-trigger-module-validation-pipeline",level:3},{value:"Step 1: Navigate to Module Directory",id:"step-1-navigate-to-module-directory",level:4},{value:"Step 2: Initialize Git Repository",id:"step-2-initialize-git-repository",level:4},{value:"Step 3: Configure Git Remote",id:"step-3-configure-git-remote",level:4},{value:"Step 4: Verify Remote",id:"step-4-verify-remote",level:4},{value:"Step 5: Push Code",id:"step-5-push-code",level:4},{value:"Step 6: Monitor Pipeline Execution",id:"step-6-monitor-pipeline-execution",level:4},{value:"3.7 Trigger Deployment Pipeline",id:"37-trigger-deployment-pipeline",level:3},{value:"Step 1: Navigate to Production Workload Directory",id:"step-1-navigate-to-production-workload-directory",level:4},{value:"Step 2: Create and Configure provider.tf",id:"step-2-create-and-configure-providertf",level:4},{value:"Step 3: Create variables.tf and main.tf",id:"step-3-create-variablestf-and-maintf",level:4},{value:"Step 4: Create Tests",id:"step-4-create-tests",level:4},{value:"Step 5: Initialize Git and Configure Remote",id:"step-5-initialize-git-and-configure-remote",level:4},{value:"Step 6: Push Code",id:"step-6-push-code",level:4},{value:"Step 7: Monitor Deployment Pipeline",id:"step-7-monitor-deployment-pipeline",level:4},{value:"3.7 Multi-Account Considerations",id:"37-multi-account-considerations",level:3},{value:"Enterprise Architecture",id:"enterprise-architecture",level:4},{value:"Cross-Account Deployment",id:"cross-account-deployment",level:4},{value:"Task 4: Manual Approval and Notifications",id:"task-4-manual-approval-and-notifications",level:2},{value:"Objective",id:"objective-3",level:3},{value:"4.1 Add Manual Approval Stage",id:"41-add-manual-approval-stage",level:3},{value:"Step 1: Navigate to Directory",id:"step-1-navigate-to-directory-1",level:4},{value:"Step 2: Update main.tf",id:"step-2-update-maintf",level:4},{value:"Step 3: Apply Changes",id:"step-3-apply-changes",level:4},{value:"Step 4: Verify Manual Approval Stage",id:"step-4-verify-manual-approval-stage",level:4},{value:"4.2 Add SNS Notifications",id:"42-add-sns-notifications",level:3},{value:"Step 1: Create SNS Topic and Subscription",id:"step-1-create-sns-topic-and-subscription",level:4},{value:"Step 2: Update Manual Approval Configuration",id:"step-2-update-manual-approval-configuration",level:4},{value:"Step 3: Apply SNS Configuration",id:"step-3-apply-sns-configuration",level:4},{value:"Step 4: Confirm SNS Subscription",id:"step-4-confirm-sns-subscription",level:4},{value:"4.3 Test Manual Approval Workflow",id:"43-test-manual-approval-workflow",level:3},{value:"Step 1: Navigate to Production Workload",id:"step-1-navigate-to-production-workload",level:4},{value:"Step 2: Make a Code Change",id:"step-2-make-a-code-change",level:4},{value:"Step 3: Push Changes",id:"step-3-push-changes",level:4},{value:"Step 4: Monitor Pipeline",id:"step-4-monitor-pipeline",level:4},{value:"Step 5: Receive Email Notification",id:"step-5-receive-email-notification",level:4},{value:"Step 6: Review and Approve",id:"step-6-review-and-approve",level:4},{value:"Step 7: Verify Apply Execution",id:"step-7-verify-apply-execution",level:4},{value:"4.4 Approval Best Practices",id:"44-approval-best-practices",level:3},{value:"Task 5: Resource Cleanup",id:"task-5-resource-cleanup",level:2},{value:"Objective",id:"objective-4",level:3},{value:"5.1 Delete Example Production Resources",id:"51-delete-example-production-resources",level:3},{value:"Step 1: Navigate to Production Workload Directory",id:"step-1-navigate-to-production-workload-directory-1",level:4},{value:"Step 2: Remove Resource Configurations",id:"step-2-remove-resource-configurations",level:4},{value:"Step 3: Push Changes to Trigger Destroy",id:"step-3-push-changes-to-trigger-destroy",level:4},{value:"Step 4: Monitor Pipeline Execution",id:"step-4-monitor-pipeline-execution",level:4},{value:"5.2 Destroy AWS DevOps Core Infrastructure",id:"52-destroy-aws-devops-core-infrastructure",level:3},{value:"Step 1: Navigate to aws-devops-core Directory",id:"step-1-navigate-to-aws-devops-core-directory",level:4},{value:"Step 2: Remove S3 Backend Configuration",id:"step-2-remove-s3-backend-configuration",level:4},{value:"Step 3: Migrate State from S3 to Local",id:"step-3-migrate-state-from-s3-to-local",level:4},{value:"Step 4: Destroy All Infrastructure",id:"step-4-destroy-all-infrastructure",level:4},{value:"5.3 Delete CloudFormation Stack (If Applicable)",id:"53-delete-cloudformation-stack-if-applicable",level:3},{value:"Step 1: Navigate to CloudFormation",id:"step-1-navigate-to-cloudformation",level:4},{value:"Step 2: Delete Stack",id:"step-2-delete-stack",level:4},{value:"5.4 Cleanup Verification Checklist",id:"54-cleanup-verification-checklist",level:3},{value:"5.5 Final Cost Verification",id:"55-final-cost-verification",level:3},{value:"Key Takeaways",id:"key-takeaways",level:2},{value:"1. State Management",id:"1-state-management",level:3},{value:"2. Shift-Left Security",id:"2-shift-left-security",level:3},{value:"3. Automated Validation",id:"3-automated-validation",level:3},{value:"4. Pipeline Orchestration",id:"4-pipeline-orchestration",level:3},{value:"5. Governance and Compliance",id:"5-governance-and-compliance",level:3},{value:"6. Infrastructure as Code Best Practices",id:"6-infrastructure-as-code-best-practices",level:3},{value:"Workshop Completion Status",id:"workshop-completion-status",level:2},{value:"Additional Resources",id:"additional-resources",level:2},{value:"Terraform Resources",id:"terraform-resources",level:3},{value:"AWS CI/CD Resources",id:"aws-cicd-resources",level:3},{value:"Security and Compliance",id:"security-and-compliance",level:3},{value:"Community and Support",id:"community-and-support",level:3}];function d(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",img:"img",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"hands-on-implementing-terraform-cicd-pipelines-and-security-testing-on-aws",children:"Hands-On: Implementing Terraform CI/CD Pipelines and Security Testing on AWS"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Focus:"})," Infrastructure as Code, CI/CD Automation, Security Scanning, and Testing\n",(0,r.jsx)(n.strong,{children:"Duration:"})," 5 hours",(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.strong,{children:"Level:"})," Intermediate",(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.strong,{children:"Status:"})," Completed",(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.strong,{children:"Author:"})," HoangBaoPhuoc (phuochb)",(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.strong,{children:"Co-author:"})," PNg-HA (Anh Pham)"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"This workshop demonstrates the implementation of a robust CI/CD pipeline for Terraform on AWS. The objective is to transition from manual infrastructure management to a fully automated, tested, and secure deployment workflow using AWS native tools and third-party security scanners."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"AWS account with administrator or sandbox permissions"}),"\n",(0,r.jsx)(n.li,{children:"AWS CLI configured on your workstation (or equivalent cloud IDE)"}),"\n",(0,r.jsx)(n.li,{children:"Git installed"}),"\n",(0,r.jsx)(n.li,{children:"Terraform and tfenv installed"}),"\n",(0,r.jsx)(n.li,{children:"Optional: Docker installed if you plan to run containerized tests locally"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"workshop-scenario",children:"Workshop Scenario"}),"\n",(0,r.jsx)(n.p,{children:"As a Cloud Security Engineer, you are tasked with automating the deployment of AWS infrastructure for an enterprise environment. The solution ensures that all Terraform modules are validated for syntax, tested for logic using the Terraform Test Framework, and scanned for security vulnerabilities using Checkov before being deployed via AWS CodePipeline."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"task-1-environment-setup-and-ide-configuration",children:"Task 1: Environment Setup and IDE Configuration"}),"\n",(0,r.jsx)(n.h3,{id:"objective",children:"Objective"}),"\n",(0,r.jsx)(n.p,{children:"Prepare the development environment by configuring the Integrated Development Environment (IDE) and ensuring necessary CLI tools are installed."}),"\n",(0,r.jsx)(n.h3,{id:"steps",children:"Steps"}),"\n",(0,r.jsx)(n.h4,{id:"11-aws-account--region-selection",children:"1.1 AWS Account & Region Selection"}),"\n",(0,r.jsxs)(n.p,{children:["Ensure programmatic administrator access is available. Recommended regions include ",(0,r.jsx)(n.code,{children:"us-east-1"}),", ",(0,r.jsx)(n.code,{children:"us-east-2"}),", or ",(0,r.jsx)(n.code,{children:"us-west-2"}),"."]}),"\n",(0,r.jsx)(n.h4,{id:"12-cloudformation-stack-creation",children:"1.2 CloudFormation Stack Creation"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Note: If you are running this lab locally or in your own IDE, you can skip the CloudFormation Code Editor setup and work directly in this repository."}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["On the Create stack page, in the ",(0,r.jsx)(n.strong,{children:"Prerequisite - Prepare template"})," section, select ",(0,r.jsx)(n.strong,{children:"Build from Infrastructure Composer"})," then ",(0,r.jsx)(n.strong,{children:"Create a template in Infrastructure Composer"}),".\n",(0,r.jsx)(n.img,{alt:"AWS CloudFormation - Stack Parameters Configuration for Workshop Environment",src:i(1986).A+"",width:"1747",height:"891"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Use the provided ",(0,r.jsx)(n.code,{children:"custom-code-editor.yaml"})," template to provision a Code Editor environment on Amazon EC2.\n",(0,r.jsx)(n.img,{alt:"Confirm creating S3 progress",src:i(169).A+"",width:"1747",height:"891"}),"\n",(0,r.jsx)(n.img,{alt:"Successfully import .yaml",src:i(5968).A+"",width:"1747",height:"891"}),"\n",(0,r.jsx)(n.img,{alt:"Rename stack",src:i(3999).A+"",width:"1855",height:"956"}),"\n",(0,r.jsx)(n.img,{alt:"Select to acknowledge create IAM resource",src:i(198).A+"",width:"1857",height:"953"}),"\nSubmit successfully!\n",(0,r.jsx)(n.img,{alt:"Overview stack created",src:i(9625).A+"",width:"1868",height:"961"}),"\n",(0,r.jsx)(n.img,{alt:"Overview stack output",src:i(4735).A+"",width:"1747",height:"894"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Once the stack is created, select the ",(0,r.jsx)(n.strong,{children:"Outputs"})," tab to view the relevant values we will use in the next part of the workshop. In the Outputs tab, note the ",(0,r.jsx)(n.strong,{children:"Password"})," and ",(0,r.jsx)(n.strong,{children:"URL"})," values."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"13-docker-installation-on-ubuntu-2204",children:"1.3 Docker Installation on Ubuntu 22.04"}),"\n",(0,r.jsx)(n.p,{children:"Configure Docker on the EC2 instance:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Package Manager:"})," Used ",(0,r.jsx)(n.code,{children:"apt"})," instead of ",(0,r.jsx)(n.code,{children:"yum"})," due to Ubuntu-based environment"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Service Management:"})," Enabled and started ",(0,r.jsx)(n.code,{children:"docker.service"})," using ",(0,r.jsx)(n.code,{children:"systemctl"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Permissions:"})," Added current user to the ",(0,r.jsx)(n.code,{children:"docker"})," group to enable non-root execution, as required by the workshop"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"14-verify-tooling",children:"1.4 Verify Tooling"}),"\n",(0,r.jsx)(n.p,{children:"Ensure the following are installed and accessible via terminal:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"aws-cli"})," (v2)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"terraform"})," & ",(0,r.jsx)(n.code,{children:"tfenv"})]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"checkov"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"jq"}),", ",(0,r.jsx)(n.code,{children:"git"}),", and ",(0,r.jsx)(n.code,{children:"docker"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Verify tool",src:i(1965).A+"",width:"1473",height:"716"})}),"\n",(0,r.jsx)(n.h4,{id:"15-ide-extensions",children:"1.5 IDE Extensions"}),"\n",(0,r.jsxs)(n.p,{children:["Install the ",(0,r.jsx)(n.strong,{children:"HashiCorp Terraform"})," and ",(0,r.jsx)(n.strong,{children:"Amazon Q"})," extensions for Visual Studio Code to enhance development efficiency."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{alt:"HashiCorp installed",src:i(2586).A+"",width:"1747",height:"891"}),"\n",(0,r.jsx)(n.img,{alt:"Amazon Q installed",src:i(5499).A+"",width:"1747",height:"891"})]}),"\n",(0,r.jsx)(n.h4,{id:"16-configure-ide-and-clone-repository",children:"1.6 Configure IDE and Clone Repository"}),"\n",(0,r.jsx)(n.p,{children:"Verify all resources are properly configured and successfully clone the workshop repository."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Verify successfully all resources",src:i(3174).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"task-2-local-terraform-module-development-and-testing",children:"Task 2: Local Terraform Module Development and Testing"}),"\n",(0,r.jsx)(n.h3,{id:"objective-1",children:"Objective"}),"\n",(0,r.jsx)(n.p,{children:"Develop a standardized Terraform module and perform localized testing to identify issues before committing code to the repository."}),"\n",(0,r.jsx)(n.h3,{id:"21-create-terraform-module",children:"2.1: Create Terraform Module"}),"\n",(0,r.jsx)(n.h4,{id:"overview-1",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"Create a well-structured Terraform module following best practices for organization and reusability in the workshop-terraform-cicd-and-testing-on-aws/terraform-config/modules/module-aws-tf-cicd/ directory."}),"\n",(0,r.jsx)(n.h4,{id:"module-structure",children:"Module Structure"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.strong,{children:["Provider Configuration (",(0,r.jsx)(n.code,{children:"providers.tf"}),"):"]})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Define the AWS provider with the appropriate region"}),"\n",(0,r.jsx)(n.li,{children:"Configure provider version constraints"}),"\n",(0,r.jsx)(n.li,{children:"Set up any required provider features"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.strong,{children:["Resource Blocks (",(0,r.jsx)(n.code,{children:"main.tf"}),"):"]})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Define core AWS resources (e.g., VPC, subnets, security groups, EC2 instances)"}),"\n",(0,r.jsx)(n.li,{children:"Implement proper resource dependencies"}),"\n",(0,r.jsx)(n.li,{children:"Use consistent naming conventions and tagging"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.strong,{children:["Variable Definitions (",(0,r.jsx)(n.code,{children:"variables.tf"}),"):"]})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Declare input variables for parameterization"}),"\n",(0,r.jsx)(n.li,{children:"Include descriptions and type constraints"}),"\n",(0,r.jsx)(n.li,{children:"Set default values where appropriate"}),"\n",(0,r.jsx)(n.li,{children:"Add validation rules for critical variables"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.strong,{children:["Output Configuration (",(0,r.jsx)(n.code,{children:"outputs.tf"}),"):"]})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Export important resource attributes"}),"\n",(0,r.jsx)(n.li,{children:"Provide values for use by other modules"}),"\n",(0,r.jsx)(n.li,{children:"Include descriptions for each output"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.strong,{children:["Variable Values (",(0,r.jsx)(n.code,{children:"terraform.tfvars"}),"):"]})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Specify concrete values for variables"}),"\n",(0,r.jsx)(n.li,{children:"Environment-specific configurations"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"22-terraform-test-framework",children:"2.2: Terraform Test Framework"}),"\n",(0,r.jsx)(n.h4,{id:"overview-2",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"Use the native Terraform Test Framework to validate module behavior without deploying actual infrastructure."}),"\n",(0,r.jsx)(n.h4,{id:"test-implementation",children:"Test Implementation"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Create Test Files:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Author ",(0,r.jsx)(n.code,{children:".tftest.hcl"})," files in the ",(0,r.jsx)(n.code,{children:"tests/"})," directory"]}),"\n",(0,r.jsx)(n.li,{children:"Define multiple test scenarios for different use cases"}),"\n",(0,r.jsx)(n.li,{children:"Test both success and failure conditions"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Test Structure:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Run blocks:"})," Define test scenarios with specific configurations"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Assert blocks:"})," Validate resource attributes and outputs"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Mock providers:"})," Test without creating real resources (where applicable)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Execute Tests:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:" cd terraform-config/modules/module-aws-tf-cicd\n terraform init\n terraform test\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Validate Results:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Review test output for passes and failures"}),"\n",(0,r.jsx)(n.li,{children:"Ensure all assertions succeed"}),"\n",(0,r.jsx)(n.li,{children:"Check for unexpected behaviors or edge cases"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Benefits:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Catch configuration errors early in development"}),"\n",(0,r.jsx)(n.li,{children:"Validate module behavior across different input scenarios"}),"\n",(0,r.jsx)(n.li,{children:"Ensure consistency and compliance with organizational standards"}),"\n",(0,r.jsx)(n.li,{children:"Reduce deployment failures in CI/CD pipelines"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Successful terraform test results",src:i(2608).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"23-security-scanning-with-checkov",children:"2.3: Security Scanning with Checkov"}),"\n",(0,r.jsx)(n.h4,{id:"overview-3",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"Perform static security analysis to identify misconfigurations and compliance violations before code reaches production."}),"\n",(0,r.jsx)(n.h4,{id:"checkov-implementation",children:"Checkov Implementation"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Run Security Scan:"}),"\nRun checkov --directory /path-to-your-module-directory replacing /path-to-your-module-directory with the output in the terminal after you ran the pwd command."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"    pwd\n    checkov --directory workshop/workshop-terraform-cicd-and-testing-on-aws/terraform-config/modules/module-aws-tf-cicd\n\n    # Alternatively, you can just run checkov -d . to run it against all files in the current directory.\n    checkov -d . --compact\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Review Scan Results:"}),"\nAnalyze findings for common security issues:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Storage Security:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Unencrypted S3 buckets"}),"\n",(0,r.jsx)(n.li,{children:"Missing S3 bucket versioning"}),"\n",(0,r.jsx)(n.li,{children:"Unencrypted EBS volumes"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Network Security:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Overly permissive security group rules (0.0.0.0/0)"}),"\n",(0,r.jsx)(n.li,{children:"Missing network ACL restrictions"}),"\n",(0,r.jsx)(n.li,{children:"Public subnet configurations"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Access Control:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Overly broad IAM policies"}),"\n",(0,r.jsx)(n.li,{children:"Missing MFA requirements"}),"\n",(0,r.jsx)(n.li,{children:"Public access to sensitive resources"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Compliance:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Missing encryption at rest"}),"\n",(0,r.jsx)(n.li,{children:"Unencrypted data in transit"}),"\n",(0,r.jsx)(n.li,{children:"Missing logging and monitoring"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Remediate Issues:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Fix critical and high-severity findings immediately"}),"\n",(0,r.jsx)(n.li,{children:"Document accepted risks for low-severity findings"}),"\n",(0,r.jsx)(n.li,{children:"Update Terraform code to align with security best practices"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Verify Compliance:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Re-run Checkov to confirm all critical issues are resolved"}),"\n",(0,r.jsx)(n.li,{children:"Generate compliance report for audit purposes"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Checkov Benefits:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Shift-left security approach"}),"\n",(0,r.jsx)(n.li,{children:"Automated compliance validation against industry standards (CIS, PCI-DSS, HIPAA)"}),"\n",(0,r.jsx)(n.li,{children:"Integration with CI/CD pipelines"}),"\n",(0,r.jsx)(n.li,{children:"Support for multiple IaC frameworks (Terraform, CloudFormation, Kubernetes)"}),"\n",(0,r.jsx)(n.li,{children:"Customizable policies for organizational requirements"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{alt:"Checkov scan output showing passed/failed checks",src:i(3785).A+"",width:"1747",height:"891"}),"\n",(0,r.jsx)(n.img,{alt:"alt text",src:i(33).A+"",width:"1747",height:"891"}),"\n",(0,r.jsx)(n.img,{alt:"alt text",src:i(9979).A+"",width:"1747",height:"891"}),"\n",(0,r.jsx)(n.img,{alt:"alt text",src:i(9030).A+"",width:"1747",height:"891"}),"\n",(0,r.jsx)(n.img,{alt:"alt text",src:i(9306).A+"",width:"1747",height:"891"}),"\n",(0,r.jsx)(n.img,{alt:"alt text",src:i(8896).A+"",width:"1747",height:"891"}),"\n",(0,r.jsx)(n.img,{alt:"alt text",src:i(6271).A+"",width:"1747",height:"891"}),"\n",(0,r.jsx)(n.img,{alt:"alt text",src:i(3610).A+"",width:"1747",height:"891"}),"\n",(0,r.jsx)(n.img,{alt:"alt text",src:i(7393).A+"",width:"1747",height:"891"}),"\n",(0,r.jsx)(n.img,{alt:"alt text",src:i(1828).A+"",width:"1747",height:"891"}),"\n",(0,r.jsx)(n.img,{alt:"alt text",src:i(7507).A+"",width:"1747",height:"891"}),"\n",(0,r.jsx)(n.img,{alt:"alt text",src:i(3679).A+"",width:"1747",height:"891"})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"task-3-cicd-pipeline-implementation",children:"Task 3: CI/CD Pipeline Implementation"}),"\n",(0,r.jsx)(n.h3,{id:"objective-2",children:"Objective"}),"\n",(0,r.jsx)(n.p,{children:"Automate the deployment process by establishing a remote backend and implementing a multi-stage CI/CD pipeline using AWS native services."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"31-pipeline-architecture",children:"3.1 Pipeline Architecture"}),"\n",(0,r.jsx)(n.h4,{id:"terraform-module-validation-pipeline",children:"Terraform Module Validation Pipeline"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Source:"})," ",(0,r.jsx)(n.code,{children:"module-aws-tf-cicd"})," S3 bucket"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Purpose:"})," Validates module functionality and security"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Stages:"})," Pull Code \u2192 Terraform Test \u2192 Checkov Scan"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"terraform-deployment-pipeline",children:"Terraform Deployment Pipeline"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Source:"})," ",(0,r.jsx)(n.code,{children:"example-production-workload"})," S3 bucket"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Purpose:"})," Validates and deploys production infrastructure"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Stages:"})," Pull Code \u2192 Terraform Test \u2192 Checkov Scan \u2192 Terraform Apply"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"32-resources-overview",children:"3.2 Resources Overview"}),"\n",(0,r.jsx)(n.h4,{id:"pipelines--build-projects",children:"Pipelines & Build Projects"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pipelines:"})," ",(0,r.jsx)(n.code,{children:"tf-module-validation-pipeline"}),", ",(0,r.jsx)(n.code,{children:"tf-deployment-pipeline"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Build Projects:"})," TerraformTest and Checkov projects for each component"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"S3 Buckets:"})," Git repos (",(0,r.jsx)(n.code,{children:"module-aws-tf-cicd"}),", ",(0,r.jsx)(n.code,{children:"aws-devops-core"}),", ",(0,r.jsx)(n.code,{children:"example-production-workload"}),") and state buckets"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"33-understanding-git-remote-s3",children:"3.3 Understanding Git-Remote-S3"}),"\n",(0,r.jsxs)(n.p,{children:["This workshop uses ",(0,r.jsx)(n.strong,{children:"git-remote-s3"})," to simulate repositories without external providers."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Features:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Protocol: ",(0,r.jsx)(n.code,{children:"s3+zip://"})," instead of ",(0,r.jsx)(n.code,{children:"https://"})]}),"\n",(0,r.jsx)(n.li,{children:"Trigger: S3 source action in CodePipeline"}),"\n",(0,r.jsx)(n.li,{children:"EventBridge detects S3 changes and triggers pipeline"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"34-deploy-infrastructure",children:"3.4 Deploy Infrastructure"}),"\n",(0,r.jsx)(n.h4,{id:"step-1-navigate-to-directory",children:"Step 1: Navigate to Directory"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd workshop/workshop-terraform-cicd-and-testing-on-aws/terraform-config/aws-devops-core\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-2-create-configuration-files",children:"Step 2: Create Configuration Files"}),"\n",(0,r.jsx)(n.p,{children:"Create the following files with provided configurations:"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"provider.tf"})," - AWS provider and backend (commented for now)"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"locals.tf"})," - Centralized naming and configuration values"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"variables.tf"})," - Input variables with defaults"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"ecr.tf"})," - ECR repository for Checkov image (avoids DockerHub throttling)"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"outputs.tf"})," - Exports S3 state bucket names for reference"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"main.tf"})," - Uses the module created earlier to deploy all resources"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-3-verify-and-deploy-resources",children:"Step 3: Verify and Deploy Resources"}),"\n",(0,r.jsx)(n.p,{children:"After verify docker, deploy the following terraform resources"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"terraform init\nterraform plan\nterraform apply -auto-approve\n"})}),"\n",(0,r.jsx)(n.h4,{id:"step-4-save-outputs",children:"Step 4: Save Outputs"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Important:"}),' Copy these values ("aws_devops_core" = "aws-devops-core-XXXX") - you\'ll need them later!']}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'Apply complete! Resources: 63 added, 0 changed, 0 destroyed.\n\nOutputs:\naws_devops_core_s3_bucket_name = "aws-devops-core-tf-state-XXXX"\nexample_production_workload_s3_bucket_name = "example-prod-workload-tf-state-XXXX"\ngit_remote_s3_bucket_names = tomap({\n  "aws_devops_core" = "aws-devops-core-XXXX"\n  "example_production_workload" = "example-prod-workload-XXXX"\n  "module_aws_tf_cicd" = "module-aws-tf-cicd-XXXX"\n})\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Terraform apply success with outputs",src:i(7756).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-6-check-codepipeline-expected-error",children:"Step 6: Check CodePipeline (Expected Error)"}),"\n",(0,r.jsx)(n.p,{children:"Navigate to AWS Console \u2192 CodePipeline. You'll see pipelines with failed status."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Codepipeline console search",src:i(4293).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Codepipeline dashboard pipeline error",src:i(8665).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsxs)(n.p,{children:["Click on a pipeline to see details. The ",(0,r.jsx)(n.code,{children:"PullFromS3"})," action failed because buckets are empty (no ",(0,r.jsx)(n.code,{children:"main"})," branch yet)."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Codepipeline s3 error",src:i(6560).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"This error is expected!"})," Pipelines will succeed once we push code to the repositories."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"35-configure-s3-remote-backend",children:"3.5 Configure S3 Remote Backend"}),"\n",(0,r.jsx)(n.h4,{id:"why-remote-state",children:"Why Remote State?"}),"\n",(0,r.jsx)(n.p,{children:"Local state files prevent collaboration. Remote backends (S3) enable:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Centralized state storage"}),"\n",(0,r.jsx)(n.li,{children:"Team collaboration"}),"\n",(0,r.jsx)(n.li,{children:"State locking (prevents concurrent modifications)"}),"\n",(0,r.jsx)(n.li,{children:"Version control with S3 versioning"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-1-edit-providertf",children:"Step 1: Edit provider.tf"}),"\n",(0,r.jsxs)(n.p,{children:["Uncomment the backend block (press ",(0,r.jsx)(n.code,{children:"CMD + /"})," on Mac or ",(0,r.jsx)(n.code,{children:"CTRL + /"})," on Windows):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-hcl",children:'backend "s3" {\n  bucket         = "add-your-bucket-name-here"\n  key            = "state/terraform.tfstate"\n  region         = "us-east-1"\n  encrypt        = true\n  use_lockfile   = true\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-2-update-bucket-name",children:"Step 2: Update Bucket Name"}),"\n",(0,r.jsxs)(n.p,{children:["Replace ",(0,r.jsx)(n.code,{children:'"add-your-bucket-name-here"'})," with your ",(0,r.jsx)(n.code,{children:"aws_devops_core_s3_bucket_name"})," from outputs."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-hcl",children:'backend "s3" {\n  bucket         = "aws-devops-core-tf-state-XXXX"\n  key            = "state/terraform.tfstate"\n  region         = "us-east-1"\n  encrypt        = true\n  use_lockfile   = true\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Note on State Locking:"})," The ",(0,r.jsx)(n.code,{children:"use_lockfile"})," argument enables state locking using S3 conditional writes (new in Terraform 1.10+). Previously required DynamoDB."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-3-migrate-state",children:"Step 3: Migrate State"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"terraform init\n"})}),"\n",(0,r.jsxs)(n.p,{children:["When prompted to copy existing state, type ",(0,r.jsx)(n.code,{children:"yes"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Do you want to copy existing state to the new backend?\nEnter a value: yes\n"})}),"\n",(0,r.jsx)(n.p,{children:"You should see:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'Successfully configured the backend "s3"!\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Terraform init migration success",src:i(1963).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-4-verify-in-s3",children:"Step 4: Verify in S3"}),"\n",(0,r.jsxs)(n.p,{children:["Navigate to S3 Console \u2192 Select bucket starting with ",(0,r.jsx)(n.code,{children:"aws-devops-core-tf-state"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["You should see: ",(0,r.jsx)(n.code,{children:"state/"})," folder containing ",(0,r.jsx)(n.code,{children:"terraform.tfstate"})," file."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"State folder created",src:i(4658).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"State file moved to s3",src:i(7453).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"36-trigger-module-validation-pipeline",children:"3.6 Trigger Module Validation Pipeline"}),"\n",(0,r.jsx)(n.h4,{id:"step-1-navigate-to-module-directory",children:"Step 1: Navigate to Module Directory"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd ../modules/module-aws-tf-cicd\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-2-initialize-git-repository",children:"Step 2: Initialize Git Repository"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"git init\ngit branch -M main\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-3-configure-git-remote",children:"Step 3: Configure Git Remote"}),"\n",(0,r.jsx)(n.p,{children:"Get your S3 bucket name from outputs:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# View all outputs\nterraform -chdir=../../aws-devops-core output\n\n# Or get specific bucket name\nterraform -chdir=../../aws-devops-core output -json git_remote_s3_bucket_names | jq -r '.\"module_aws_tf_cicd\"'\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Add remote (replace ",(0,r.jsx)(n.code,{children:"your-s3-bucket-name"})," with your actual bucket name):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"git remote add origin s3+zip://your-s3-bucket-name/s3-repo\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Important:"})," Include ",(0,r.jsx)(n.code,{children:"/s3-repo"})," suffix - EventBridge looks for this pattern!"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-4-verify-remote",children:"Step 4: Verify Remote"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"git remote -v\n"})}),"\n",(0,r.jsx)(n.p,{children:"Expected output:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"origin  s3+zip://module-aws-tf-cicd-XXXX/s3-repo (fetch)\norigin  s3+zip://module-aws-tf-cicd-XXXX/s3-repo (push)\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-5-push-code",children:"Step 5: Push Code"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'git add .\ngit commit -m "Initial commit"\ngit push origin -u main\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-6-monitor-pipeline-execution",children:"Step 6: Monitor Pipeline Execution"}),"\n",(0,r.jsx)(n.p,{children:"Navigate to AWS Console \u2192 CodePipeline."}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"tf-module-validation-module-aws-tf-cicd"})," pipeline status should be ",(0,r.jsx)(n.strong,{children:"In progress"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Codepipeline run in progress",src:i(6324).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsx)(n.p,{children:"After a few minutes, the pipeline should complete successfully."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{alt:"Codepipeline run successful",src:i(8783).A+"",width:"1747",height:"891"}),"\n",(0,r.jsx)(n.img,{alt:"Codepipeline run successful overview pipeline",src:i(3686).A+"",width:"1747",height:"891"})]}),"\n",(0,r.jsx)(n.p,{children:"Click on the pipeline name to view detailed logs for each stage."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"37-trigger-deployment-pipeline",children:"3.7 Trigger Deployment Pipeline"}),"\n",(0,r.jsx)(n.h4,{id:"step-1-navigate-to-production-workload-directory",children:"Step 1: Navigate to Production Workload Directory"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd ../../example-production-workload\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-2-create-and-configure-providertf",children:"Step 2: Create and Configure provider.tf"}),"\n",(0,r.jsx)(n.p,{children:"Open the provider.tf file located in the terraform-config/example-production-workload/provider.tf directory. Once there, paste the following configuration below the."}),"\n",(0,r.jsxs)(n.p,{children:["Uncomment backend block and update with ",(0,r.jsx)(n.code,{children:"example_production_workload_s3_bucket_name"}),":"]}),"\n",(0,r.jsx)(n.p,{children:"Get bucket name:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"terraform -chdir=../aws-devops-core output example_production_workload_s3_bucket_name\n"})}),"\n",(0,r.jsx)(n.p,{children:"Updated provider.tf:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-hcl",children:'backend "s3" {\n  bucket         = "example-prod-workload-tf-state-XXXX"\n  key            = "state/terraform.tfstate"\n  region         = "us-east-1"\n  encrypt        = true\n  use_lockfile   = true\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-3-create-variablestf-and-maintf",children:"Step 3: Create variables.tf and main.tf"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"variables.tf"})," - Input variables with defaults"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"main.tf"})," - Production workload resources (IAM role, S3 bucket)"]}),"\n",(0,r.jsx)(n.p,{children:"Note: main.tf includes Checkov skip directives for non-critical findings"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-4-create-tests",children:"Step 4: Create Tests"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"tests/main.tftest.hcl"})," -- Integration tests validating:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"IAM role naming conventions"}),"\n",(0,r.jsx)(n.li,{children:"Trust policy configuration"}),"\n",(0,r.jsx)(n.li,{children:"S3 bucket naming"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-hcl",children:'# HINT: Make sure to run `terraform init` in this directory before running `terraform test`. Also, ensure you use constant values (e.g. string, number, bool, etc.) within your tests where at all possible or you may encounter errors.\n\n# Configure the AWS Provider\nprovider "aws" {\n  region = "us-east-1"\n}\n\n# - End-to-end Tests -\nrun "integration_test" {\n  command = apply\n\n  # Using global variables defined above since additional variables block is not defined here\n  variables {\n    aws_region = "us-east-1"\n  }\n\n\n  # Assertions\n  # IAM Role - Ensure the role has the correct name, and trust policy after creation\n  assert {\n    condition     = startswith(aws_s3_bucket.example.id, "example-prod-resource")\n    error_message = "The IAM Role name (${aws_iam_role.example.name}) did not start with the expected value (example-prod-resource)."\n  }\n\n  assert {\n    condition     = jsondecode(aws_iam_role.example.assume_role_policy)["Statement"][0]["Principal"]["Service"] == "ec2.amazonaws.com"\n    error_message = "The IAM role trust policy (${aws_iam_role.example.assume_role_policy}) did not trust the expected service principal (ec2.amazonaws.com)"\n  }\n\n\n  # S3 - Ensure S3 Bucket have correct names after creation\n  assert {\n    condition     = startswith(aws_s3_bucket.example.id, "example-prod-resource")\n    error_message = "The S3 Remote State Bucket name (${aws_s3_bucket.example.id}) did not start with the expected value (example-prod-resource)."\n  }\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-5-initialize-git-and-configure-remote",children:"Step 5: Initialize Git and Configure Remote"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"git init\ngit branch -M main\n"})}),"\n",(0,r.jsx)(n.p,{children:"Get bucket name:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"terraform -chdir=../aws-devops-core output -json git_remote_s3_bucket_names | jq -r '.\"example_production_workload\"'\n"})}),"\n",(0,r.jsx)(n.p,{children:"Add remote:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"git remote add origin s3+zip://example-prod-workload-XXXX/s3-repo\n"})}),"\n",(0,r.jsx)(n.p,{children:"Verify:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"git remote -v\n"})}),"\n",(0,r.jsx)(n.p,{children:"Expected output:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"origin  s3+zip://example-prod-workload-XXXX/s3-repo (fetch)\norigin  s3+zip://example-prod-workload-XXXX/s3-repo (push)\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-6-push-code",children:"Step 6: Push Code"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'git add .\ngit commit -m "Initial commit"\ngit push origin -u main\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-7-monitor-deployment-pipeline",children:"Step 7: Monitor Deployment Pipeline"}),"\n",(0,r.jsx)(n.p,{children:"Navigate to AWS Console \u2192 CodePipeline."}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"tf-deployment-example-production-workload"})," pipeline status should be ",(0,r.jsx)(n.strong,{children:"In progress"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Tf deploy pipeline in progress",src:i(9841).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsx)(n.p,{children:"After a few minutes, pipeline completes successfully and deploys production infrastructure:"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{alt:"Tf deploy pipeline successful",src:i(7128).A+"",width:"1747",height:"891"}),"\n",(0,r.jsx)(n.img,{alt:"Tf deploy pipeline successful overview pipeline",src:i(1511).A+"",width:"1747",height:"891"})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"37-multi-account-considerations",children:"3.7 Multi-Account Considerations"}),"\n",(0,r.jsx)(n.h4,{id:"enterprise-architecture",children:"Enterprise Architecture"}),"\n",(0,r.jsx)(n.p,{children:"For production environments, workloads should be deployed across multiple AWS accounts:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Shared Services Account:"})," Houses CI/CD pipelines, security tools, AWS Organizations/SSO"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Production Account:"})," Production workloads and resources"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Development/Staging Accounts:"})," Separate environments per team or project"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Multi-Account architecture diagram",src:i(7133).A+"",width:"1470",height:"1103"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"cross-account-deployment",children:"Cross-Account Deployment"}),"\n",(0,r.jsxs)(n.p,{children:["To deploy resources in different accounts, use ",(0,r.jsx)(n.strong,{children:"cross-account IAM roles"})," with the ",(0,r.jsx)(n.code,{children:"assume_role"})," option:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-hcl",children:'provider "aws" {\n  region = "us-east-1"\n  assume_role {\n    role_arn = "arn:aws:iam::123456789012:role/iac"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"How It Works:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"IAM Role in Shared Services Account assumes role in Production Account via STS"}),"\n",(0,r.jsx)(n.li,{children:"STS returns temporary credentials"}),"\n",(0,r.jsx)(n.li,{children:"Terraform uses credentials to provision resources in Production Account"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"[Paste screenshot - Terraform Cross-Account Access diagram]"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Best Practices:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Separate S3 state bucket per account (managed centrally)"}),"\n",(0,r.jsx)(n.li,{children:"Configure IAM permissions for cross-account access"}),"\n",(0,r.jsx)(n.li,{children:"Use least privilege principle for assumed roles"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"task-4-manual-approval-and-notifications",children:"Task 4: Manual Approval and Notifications"}),"\n",(0,r.jsx)(n.h3,{id:"objective-3",children:"Objective"}),"\n",(0,r.jsx)(n.p,{children:"Implement a governance layer within the pipeline to ensure manual review of infrastructure changes before production deployment."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"41-add-manual-approval-stage",children:"4.1 Add Manual Approval Stage"}),"\n",(0,r.jsx)(n.p,{children:"In this section, we'll enhance the Terraform Deployment Pipeline by adding a manual approval step before the Apply stage. This ensures changes are reviewed by stakeholders before deployment."}),"\n",(0,r.jsx)(n.h4,{id:"step-1-navigate-to-directory-1",children:"Step 1: Navigate to Directory"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd workshop/workshop-terraform-cicd-and-testing-on-aws/terraform-config/aws-devops-core\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-2-update-maintf",children:"Step 2: Update main.tf"}),"\n",(0,r.jsxs)(n.p,{children:["Open ",(0,r.jsx)(n.code,{children:"main.tf"})," and add the manual approval stage configuration between the ",(0,r.jsx)(n.strong,{children:"Build_Checkov"})," and ",(0,r.jsx)(n.strong,{children:"Apply"})," stages in the ",(0,r.jsx)(n.code,{children:"tf_deployment_example_production_workload"})," pipeline."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Add this configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-hcl",children:'# Add Manual Approval\n{\n  name = "Manual_Approval"\n  action = [\n    {\n      name     = "ManualApprovalAction"\n      category = "Approval"\n      owner    = "AWS"\n      provider = "Manual"\n      version  = "1"\n      configuration = {\n         CustomData      = "Please approve this deployment."\n      }\n\n      input_artifacts = []\n      output_artifacts = []\n\n      run_order = 4\n    },\n  ]\n},\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Important:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Place this stage AFTER Build_Checkov (run_order = 3)"}),"\n",(0,r.jsxs)(n.li,{children:["Update the Apply stage ",(0,r.jsx)(n.code,{children:"run_order"})," to ",(0,r.jsx)(n.code,{children:"5"})]}),"\n",(0,r.jsx)(n.li,{children:"Stages are executed in the order they appear in the configuration"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-3-apply-changes",children:"Step 3: Apply Changes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"terraform plan\nterraform apply -auto-approve\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Terraform apply successfully",src:i(5366).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-4-verify-manual-approval-stage",children:"Step 4: Verify Manual Approval Stage"}),"\n",(0,r.jsxs)(n.p,{children:["Navigate to AWS Console \u2192 CodePipeline \u2192 Select ",(0,r.jsx)(n.code,{children:"tf-deployment-example-production-workload"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["You should see the new ",(0,r.jsx)(n.code,{children:"Manual_Approval"})," stage between ",(0,r.jsx)(n.code,{children:"Build_Checkov"})," and ",(0,r.jsx)(n.code,{children:"Apply"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Manual approval stage added",src:i(9167).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"42-add-sns-notifications",children:"4.2 Add SNS Notifications"}),"\n",(0,r.jsx)(n.p,{children:"Now let's implement Amazon SNS to notify stakeholders when manual approval is needed."}),"\n",(0,r.jsx)(n.h4,{id:"step-1-create-sns-topic-and-subscription",children:"Step 1: Create SNS Topic and Subscription"}),"\n",(0,r.jsxs)(n.p,{children:["At the ",(0,r.jsx)(n.strong,{children:"top"})," of ",(0,r.jsx)(n.code,{children:"main.tf"})," (outside the module configuration), add:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-hcl",children:'resource "aws_sns_topic" "manual_approval_sns_topic" {\n  name = "manual-approval-sns-topic"\n}\n\nresource "aws_sns_topic_subscription" "manual_approval_sns_subscription" {\n  topic_arn = aws_sns_topic.manual_approval_sns_topic.arn\n  protocol  = "email"\n  endpoint  = "your@email.com"  # Replace with your email address\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Important:"})," Replace ",(0,r.jsx)(n.code,{children:"your@email.com"})," with your actual email address."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-2-update-manual-approval-configuration",children:"Step 2: Update Manual Approval Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["In the ",(0,r.jsx)(n.code,{children:"Manual_Approval"})," stage configuration, add the SNS notification:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-hcl",children:'configuration = {\n   CustomData      = "Please approve this deployment."\n   NotificationArn = aws_sns_topic.manual_approval_sns_topic.arn # Add this line\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Complete Manual Approval Stage:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-hcl",children:'# Add Manual Approval\n{\n  name = "Manual_Approval"\n  action = [\n    {\n      name     = "ManualApprovalAction"\n      category = "Approval"\n      owner    = "AWS"\n      provider = "Manual"\n      version  = "1"\n      configuration = {\n         CustomData      = "Please approve this deployment."\n         NotificationArn = aws_sns_topic.manual_approval_sns_topic.arn\n      }\n\n      input_artifacts = []\n      output_artifacts = []\n\n      run_order = 4\n    },\n  ]\n},\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-3-apply-sns-configuration",children:"Step 3: Apply SNS Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"terraform plan\nterraform apply -auto-approve\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Terraform apply successfully",src:i(1136).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-4-confirm-sns-subscription",children:"Step 4: Confirm SNS Subscription"}),"\n",(0,r.jsx)(n.p,{children:"Check the email address you provided. You should receive a subscription confirmation email from AWS SNS."}),"\n",(0,r.jsxs)(n.p,{children:["Click ",(0,r.jsx)(n.strong,{children:'"Confirm subscription"'})," in the email."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"SNS subscription confirmation email",src:i(5337).A+"",width:"1113",height:"421"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"SNS configuration success",src:i(7154).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsx)(n.p,{children:"Once confirmed, you'll receive email notifications whenever manual approval is needed."}),"\n",(0,r.jsx)(n.p,{children:'Troubleshooting Tip: SNS Subscription Loop\nIssue: Receiving an "Unsubscribe Confirmation" email immediately after attempting to subscribe.'}),"\n",(0,r.jsx)(n.p,{children:'Root Cause: This is often caused by corporate email filters, security scanners, or browser extensions that automatically "pre-click" links in emails to check for malicious content. In doing so, they inadvertently trigger the Unsubscribe link located near the confirmation button.'}),"\n",(0,r.jsx)(n.p,{children:'Solution: > 1. Click the "Resubscribe" link in the most recent AWS notification email. 2. Once the new "Subscription Confirmation" email arrives, right-click the "Confirm subscription" link and select "Open in Incognito/Private Window". 3. Verify in the AWS SNS Console that the subscription status has successfully transitioned to Confirmed.'}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"43-test-manual-approval-workflow",children:"4.3 Test Manual Approval Workflow"}),"\n",(0,r.jsx)(n.h4,{id:"step-1-navigate-to-production-workload",children:"Step 1: Navigate to Production Workload"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd ../example-production-workload\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-2-make-a-code-change",children:"Step 2: Make a Code Change"}),"\n",(0,r.jsxs)(n.p,{children:["Open ",(0,r.jsx)(n.code,{children:"main.tf"})," and update the S3 bucket prefix:"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Before:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-hcl",children:'resource "aws_s3_bucket" "example" {\n  bucket_prefix = "example-prod-resource"\n  force_destroy = true\n  ...\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"After:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-hcl",children:'resource "aws_s3_bucket" "example" {\n  bucket_prefix = "example-prod-resource-new"\n  force_destroy = true\n  ...\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-3-push-changes",children:"Step 3: Push Changes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'git add .\ngit commit -m "Test Manual Approval"\ngit push origin -u main\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Git push successfully",src:i(8699).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-4-monitor-pipeline",children:"Step 4: Monitor Pipeline"}),"\n",(0,r.jsxs)(n.p,{children:["Navigate to AWS Console \u2192 CodePipeline \u2192 Select ",(0,r.jsx)(n.code,{children:"tf-deployment-example-production-workload"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Watch the pipeline progress through:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Source"}),"\n",(0,r.jsx)(n.li,{children:"Build_TF_Test"}),"\n",(0,r.jsx)(n.li,{children:"Build_Checkov"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Manual_Approval"})," (Pipeline pauses here)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Pipeline waiting for approval",src:i(4684).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-5-receive-email-notification",children:"Step 5: Receive Email Notification"}),"\n",(0,r.jsx)(n.p,{children:"Check your email. You should receive an approval notification containing:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Pipeline name"}),"\n",(0,r.jsx)(n.li,{children:'Custom message: "Please approve this deployment."'}),"\n",(0,r.jsx)(n.li,{children:"Link to approve or reject"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Email notification",src:i(2157).A+"",width:"1113",height:"773"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-6-review-and-approve",children:"Step 6: Review and Approve"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"In the Email:"}),"\nClick the link next to ",(0,r.jsx)(n.strong,{children:'"Approve or reject:"'})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"In AWS Console:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Click on ",(0,r.jsx)(n.code,{children:"ManualApprovalAction"})," in the pipeline"]}),"\n",(0,r.jsxs)(n.li,{children:["Click ",(0,r.jsx)(n.strong,{children:'"Revisions"'})," to see the commit that triggered the pipeline"]}),"\n",(0,r.jsx)(n.li,{children:"Review the changes made in the commit"}),"\n",(0,r.jsxs)(n.li,{children:["Select the ",(0,r.jsx)(n.strong,{children:'"Approve"'})," radio button"]}),"\n",(0,r.jsx)(n.li,{children:"Optionally add a comment"}),"\n",(0,r.jsxs)(n.li,{children:["Click ",(0,r.jsx)(n.strong,{children:'"Submit"'})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Manual approval dialog",src:i(6309).A+"",width:"1869",height:"944"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-7-verify-apply-execution",children:"Step 7: Verify Apply Execution"}),"\n",(0,r.jsxs)(n.p,{children:["After approval, the pipeline continues to the ",(0,r.jsx)(n.code,{children:"Apply"})," stage and deploys the infrastructure changes."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Pipeline continuing after approval",src:i(9967).A+"",width:"1747",height:"948"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Pipeline successful completion",src:i(950).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"44-approval-best-practices",children:"4.4 Approval Best Practices"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Review Checklist:"})}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Terraform plan shows expected changes only"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","No unintended resource deletions or modifications"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Security configurations follow organizational standards"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Encryption enabled where required"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Tagging standards applied"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Cost impact is acceptable"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Change aligns with change management process"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Notification Best Practices:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Include plan summary or link in notification"}),"\n",(0,r.jsx)(n.li,{children:"Add relevant documentation links"}),"\n",(0,r.jsx)(n.li,{children:"Set approval timeout periods"}),"\n",(0,r.jsx)(n.li,{children:"Configure escalation paths for delayed approvals"}),"\n",(0,r.jsx)(n.li,{children:"Consider multiple approvers for critical environments"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"task-5-resource-cleanup",children:"Task 5: Resource Cleanup"}),"\n",(0,r.jsx)(n.h3,{id:"objective-4",children:"Objective"}),"\n",(0,r.jsx)(n.p,{children:"Deprovision all created resources to ensure cost optimization and prevent ongoing charges."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"51-delete-example-production-resources",children:"5.1 Delete Example Production Resources"}),"\n",(0,r.jsx)(n.h4,{id:"step-1-navigate-to-production-workload-directory-1",children:"Step 1: Navigate to Production Workload Directory"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd workshop/workshop-terraform-cicd-and-testing-on-aws/terraform-config/example-production-workload\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-2-remove-resource-configurations",children:"Step 2: Remove Resource Configurations"}),"\n",(0,r.jsxs)(n.p,{children:["Open ",(0,r.jsx)(n.code,{children:"main.tf"})," and ",(0,r.jsx)(n.code,{children:"main.tftest.hcl"})," files. ",(0,r.jsx)(n.strong,{children:"Delete or comment out ALL contents"})," in both files."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Important:"})," Failure to remove all contents will cause the pipeline to fail. Ensure both files are either empty or fully commented out."]}),"\n",(0,r.jsxs)(n.p,{children:["Save all changes: ",(0,r.jsx)(n.strong,{children:"File \u2192 Save All"})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-3-push-changes-to-trigger-destroy",children:"Step 3: Push Changes to Trigger Destroy"}),"\n",(0,r.jsxs)(n.p,{children:["When you run ",(0,r.jsx)(n.code,{children:"terraform apply"}),", Terraform compares your configuration files against the state file. Since we've removed all resource declarations, Terraform will detect that resources exist in the state file but not in the configuration, and will create an execution plan to ",(0,r.jsx)(n.strong,{children:"destroy"})," those resources."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'git add .\ngit commit -m "Remove all Example Production Workload TF Resources"\ngit push\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-4-monitor-pipeline-execution",children:"Step 4: Monitor Pipeline Execution"}),"\n",(0,r.jsx)(n.p,{children:"Navigate to AWS Console \u2192 CodePipeline Dashboard."}),"\n",(0,r.jsx)(n.p,{children:"The Terraform Deployment Pipeline will start running. Wait for it to complete."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Important:"})," If you completed the Manual Approval section, you'll receive an email notification. ",(0,r.jsx)(n.strong,{children:"You must approve"})," the changes for the pipeline to continue and destroy resources."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Tf destroy resources success",src:i(9124).A+"",width:"1747",height:"948"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"52-destroy-aws-devops-core-infrastructure",children:"5.2 Destroy AWS DevOps Core Infrastructure"}),"\n",(0,r.jsx)(n.p,{children:"Now let's delete the Git Remote S3 Buckets, CodeBuild Projects, CodePipeline pipelines, and all related infrastructure."}),"\n",(0,r.jsx)(n.h4,{id:"step-1-navigate-to-aws-devops-core-directory",children:"Step 1: Navigate to aws-devops-core Directory"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd ../aws-devops-core\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-2-remove-s3-backend-configuration",children:"Step 2: Remove S3 Backend Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["Open ",(0,r.jsx)(n.code,{children:"provider.tf"})," and ",(0,r.jsx)(n.strong,{children:"delete or comment out"})," the backend block."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Before (With S3 Backend):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-hcl",children:'terraform {\n  required_providers {\n    aws = {\n      source  = "hashicorp/aws"\n      version = "~> 6.0"\n    }\n  }\n\n  backend "s3" {\n    bucket         = "aws-devops-core-tf-state-XXXX"\n    key            = "state/terraform.tfstate"\n    region         = "us-east-1"\n    encrypt        = true\n    use_lockfile   = true\n  }\n}\n\nprovider "aws" {\n  region = var.aws_region\n\n  default_tags {\n    tags = {\n      Management = "Terraform"\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"After (Without S3 Backend):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-hcl",children:'terraform {\n  required_providers {\n    aws = {\n      source  = "hashicorp/aws"\n      version = "~> 6.0"\n    }\n  }\n\n  # Backend block removed - Terraform will operate locally\n}\n\nprovider "aws" {\n  region = var.aws_region\n\n  default_tags {\n    tags = {\n      Management = "Terraform"\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Save the file: ",(0,r.jsx)(n.strong,{children:"File \u2192 Save All"})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-3-migrate-state-from-s3-to-local",children:"Step 3: Migrate State from S3 to Local"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"terraform init -migrate-state\n"})}),"\n",(0,r.jsxs)(n.p,{children:["When prompted: ",(0,r.jsx)(n.strong,{children:'"Do you want to copy existing state from S3 to the new local backend?"'})]}),"\n",(0,r.jsxs)(n.p,{children:["Type ",(0,r.jsx)(n.code,{children:"yes"})," and press Enter."]}),"\n",(0,r.jsx)(n.p,{children:"You should see:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'Successfully unset the backend "s3". Terraform will now operate locally.\n\nInitializing provider plugins...\n- Reusing previous version of hashicorp/aws from the dependency lock file\n- Using previously-installed hashicorp/aws v5.34.0\n\nTerraform has been successfully initialized!\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"State migration success",src:i(5387).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-4-destroy-all-infrastructure",children:"Step 4: Destroy All Infrastructure"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"terraform destroy -auto-approve\n"})}),"\n",(0,r.jsx)(n.p,{children:"This will destroy:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Git Remote S3 Buckets (module-aws-tf-cicd, aws-devops-core, example-production-workload)"}),"\n",(0,r.jsx)(n.li,{children:"Terraform State S3 Buckets"}),"\n",(0,r.jsx)(n.li,{children:"CodePipeline pipelines"}),"\n",(0,r.jsx)(n.li,{children:"CodeBuild projects"}),"\n",(0,r.jsx)(n.li,{children:"ECR repository"}),"\n",(0,r.jsx)(n.li,{children:"SNS topic and subscriptions"}),"\n",(0,r.jsx)(n.li,{children:"IAM roles and policies"}),"\n",(0,r.jsx)(n.li,{children:"EventBridge rules"}),"\n",(0,r.jsx)(n.li,{children:"All related infrastructure"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Wait for the command to complete. You should see:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Destroy complete! Resources: 64 destroyed.\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Terraform destroy output",src:i(7906).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsx)(n.p,{children:"Cleanup Troubleshooting: Validation Error during Destroy\nIssue: Encountered Error: filter_policy is required when filter_policy_scope is set during the final destruction phase."}),"\n",(0,r.jsx)(n.p,{children:"Root Cause: Strict validation rules in the AWS Provider v6.x prevented the state refresh because of a mismatch in SNS subscription attributes, even during a delete operation."}),"\n",(0,r.jsx)(n.p,{children:"Resolution: > * Executed terraform state rm aws_sns_topic_subscription.manual_approval_sns_subscription to decouple the problematic resource from the Terraform state."}),"\n",(0,r.jsx)(n.p,{children:"Successfully ran terraform destroy for the remaining 60+ resources."}),"\n",(0,r.jsx)(n.p,{children:"Performed a final manual cleanup in the AWS SNS Console to ensure no orphan subscriptions remained."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"53-delete-cloudformation-stack-if-applicable",children:"5.3 Delete CloudFormation Stack (If Applicable)"}),"\n",(0,r.jsx)(n.h4,{id:"step-1-navigate-to-cloudformation",children:"Step 1: Navigate to CloudFormation"}),"\n",(0,r.jsx)(n.p,{children:"Go to AWS Console \u2192 CloudFormation"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"step-2-delete-stack",children:"Step 2: Delete Stack"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Find your CloudFormation stack (default name: ",(0,r.jsx)(n.code,{children:"Terraform-CICD-Workshop"})," or custom name you provided)"]}),"\n",(0,r.jsx)(n.li,{children:"Select the stack"}),"\n",(0,r.jsxs)(n.li,{children:["Click ",(0,r.jsx)(n.strong,{children:"Delete"})]}),"\n",(0,r.jsx)(n.li,{children:"Confirm deletion"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This will terminate the EC2 instance running the Code Editor and remove all related resources."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"CloudFormation stack deletion",src:i(3993).A+"",width:"1747",height:"891"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"54-cleanup-verification-checklist",children:"5.4 Cleanup Verification Checklist"}),"\n",(0,r.jsx)(n.p,{children:"Verify all resources have been removed:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Infrastructure Resources:"})}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Example production workload resources destroyed (IAM role, S3 bucket)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","CodePipeline pipelines deleted (tf-module-validation, tf-deployment)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","CodeBuild projects deleted (TerraformTest, Checkov, TFApply projects)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Git Remote S3 buckets deleted (module-aws-tf-cicd, aws-devops-core, example-production-workload)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Terraform State S3 buckets deleted (aws-devops-core-tf-state, example-prod-workload-tf-state)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","ECR repository deleted (checkov)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","SNS topic deleted (manual-approval-sns-topic)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","SNS email subscription removed"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","IAM roles and policies deleted"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","EventBridge rules deleted"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Workshop Environment:"})}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","CloudFormation stack deleted (if applicable)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","EC2 Code Editor instance terminated (if applicable)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","No remaining resources in AWS account"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"55-final-cost-verification",children:"5.5 Final Cost Verification"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check for Unexpected Charges:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Navigate to AWS Cost Explorer"}),"\n",(0,r.jsx)(n.li,{children:"Review costs for the last 7 days"}),"\n",(0,r.jsx)(n.li,{children:"Look for any unexpected charges"}),"\n",(0,r.jsx)(n.li,{children:"Set up billing alerts for future monitoring"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Common Resources to Double-Check:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"S3 buckets (ensure all are deleted or empty)"}),"\n",(0,r.jsx)(n.li,{children:"EC2 instances (ensure all are terminated)"}),"\n",(0,r.jsx)(n.li,{children:"NAT Gateways (if any were created)"}),"\n",(0,r.jsx)(n.li,{children:"Elastic IPs (ensure none are allocated)"}),"\n",(0,r.jsx)(n.li,{children:"EBS volumes (ensure none are orphaned)"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,r.jsx)(n.h3,{id:"1-state-management",children:"1. State Management"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Utilizing S3 and DynamoDB for remote state is essential for:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Team collaboration and concurrent development"}),"\n",(0,r.jsx)(n.li,{children:"Pipeline stability and consistency"}),"\n",(0,r.jsx)(n.li,{children:"State history and disaster recovery"}),"\n",(0,r.jsx)(n.li,{children:"Preventing state file corruption"}),"\n",(0,r.jsx)(n.li,{children:"Audit trails and change tracking"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"2-shift-left-security",children:"2. Shift-Left Security"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Integrating Checkov early in the development lifecycle:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Prevents security debt accumulation"}),"\n",(0,r.jsx)(n.li,{children:"Reduces risk of deploying vulnerable infrastructure"}),"\n",(0,r.jsx)(n.li,{children:"Enforces compliance with industry standards (CIS, PCI-DSS, HIPAA)"}),"\n",(0,r.jsx)(n.li,{children:"Catches misconfigurations before production"}),"\n",(0,r.jsx)(n.li,{children:"Provides actionable remediation guidance"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3-automated-validation",children:"3. Automated Validation"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"The Terraform Test Framework provides:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Rigorous logic verification without infrastructure costs"}),"\n",(0,r.jsx)(n.li,{children:"Confidence in module behavior across different scenarios"}),"\n",(0,r.jsx)(n.li,{children:"Regression testing for code changes"}),"\n",(0,r.jsx)(n.li,{children:"Documentation through executable tests"}),"\n",(0,r.jsx)(n.li,{children:"Faster feedback loops for developers"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"4-pipeline-orchestration",children:"4. Pipeline Orchestration"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"AWS CodePipeline delivers:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Seamless integration with AWS native services"}),"\n",(0,r.jsx)(n.li,{children:"Automated end-to-end IaC workflows"}),"\n",(0,r.jsx)(n.li,{children:"Visual pipeline monitoring and troubleshooting"}),"\n",(0,r.jsx)(n.li,{children:"Scalable and reliable deployment processes"}),"\n",(0,r.jsx)(n.li,{children:"Native integration with AWS security and compliance tools"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"5-governance-and-compliance",children:"5. Governance and Compliance"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Manual approval gates ensure:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Human oversight for critical changes"}),"\n",(0,r.jsx)(n.li,{children:"Alignment with change management processes"}),"\n",(0,r.jsx)(n.li,{children:"Risk mitigation through peer review"}),"\n",(0,r.jsx)(n.li,{children:"Audit trails for compliance requirements"}),"\n",(0,r.jsx)(n.li,{children:"Controlled deployment cadence"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"6-infrastructure-as-code-best-practices",children:"6. Infrastructure as Code Best Practices"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key principles demonstrated:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Version control for all infrastructure code"}),"\n",(0,r.jsx)(n.li,{children:"Modular and reusable Terraform configurations"}),"\n",(0,r.jsx)(n.li,{children:"Automated testing at multiple levels"}),"\n",(0,r.jsx)(n.li,{children:"Security scanning as part of CI/CD"}),"\n",(0,r.jsx)(n.li,{children:"Immutable infrastructure deployments"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"workshop-completion-status",children:"Workshop Completion Status"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Section"}),(0,r.jsx)(n.th,{children:"Status"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Task 1: Environment Configuration"}),(0,r.jsx)(n.td,{children:"COMPLETED"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Task 2: Local Module Development & Testing"}),(0,r.jsx)(n.td,{children:"COMPLETED"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Task 3: CI/CD Pipeline Implementation"}),(0,r.jsx)(n.td,{children:"COMPLETED"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Task 4: Manual Approval Gates"}),(0,r.jsx)(n.td,{children:"COMPLETED"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Task 5: Resource Cleanup"}),(0,r.jsx)(n.td,{children:"COMPLETED"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Overall Result:"})," SUCCESSFUL"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"additional-resources",children:"Additional Resources"}),"\n",(0,r.jsx)(n.h3,{id:"terraform-resources",children:"Terraform Resources"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.terraform.io/docs",children:"Terraform Documentation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://developer.hashicorp.com/terraform/language/tests",children:"Terraform Test Framework Guide"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.terraform-best-practices.com/",children:"Terraform Best Practices"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"aws-cicd-resources",children:"AWS CI/CD Resources"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/codepipeline/",children:"AWS CodePipeline Documentation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/codebuild/",children:"AWS CodeBuild Documentation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/codecommit/",children:"AWS CodeCommit Documentation"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"security-and-compliance",children:"Security and Compliance"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.checkov.io/documentation.html",children:"Checkov Documentation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://aws.amazon.com/architecture/security-identity-compliance/",children:"AWS Security Best Practices"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.cisecurity.org/benchmark/amazon_web_services",children:"CIS AWS Foundations Benchmark"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"community-and-support",children:"Community and Support"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://discuss.hashicorp.com/",children:"HashiCorp Community Forum"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsxs)(n.a,{href:"https://repost.aws/",children:["AWS re",":Post"]})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://registry.terraform.io/",children:"Terraform Registry"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},950(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-31-b315f4cfec872120abee3aa49b23e1a2.png"},1136(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-24-e736f74e136de3d5acaa27694bd0ec03.png"},1511(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-20-e094c904c90e6dcf3bfa467312f0f276.png"},1828(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-8b-93ca14db002d136e8d7dab1c31fcc5a1.png"},1963(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-12-f5fddf1ffe42f34b9368b52c7e96911f.png"},1965(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/1.6-99d8d69b3e6b03796d98ece46d28bbb2.png"},1986(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/1.1-bf40a5096b5e142ddc89e71559c8d2c3.png"},2157(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-32-baf4cad303d5ec290a071a91cefa0f0e.png"},2586(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-1-3e250804af2ca1e0c9603520667d4aa4.png"},2608(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-4-1699957fd1c7c76c01d8d5b87c7f13a3.png"},3174(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-2-fe937b8342e0cca020d6169164a11bb4.png"},3610(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-6b-e1fdfb503f31ac8fb2eba9e2fae116ba.png"},3679(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-10b-7fdfd88a152fa9a8bb84f3862dd49556.png"},3686(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-17-c8407be7102067f3f003a5f646e4dfe8.png"},3785(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-5-8a760de32ccb302a111f99dd82740c43.png"},3993(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-36-284b6ad9d168b179b4b2ab35c1e0ef17.png"},3999(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/1.4-f0067161985f44bc0008ac8e65175d19.png"},4293(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-9-9d2baaf212aa04677df04198cedb9f50.png"},4658(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-13-88bb7b46c6fbd292a81d32d9885940de.png"},4684(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-28-41e9d43e4e5526b8ddf4bad2a5a5d19e.png"},4735(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/Screenshot_14-1-2026_214646_ap-southeast-2.console.aws.amazon.com-49e91a2707b5d189ad19dab25ae0d934.jpeg"},5337(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-25-9eccb6936294300b7c6c1ae9571c9be6.png"},5366(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-22-118494ee81a99ed034abb51697709643.png"},5387(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-34-55930a8fb367a5c5715eef7912e78c71.png"},5499(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-aa5b94f184e3017289a9b205bba40f59.png"},5968(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/1.3-ba68b1709ec88ba7ef349394d7f6742e.png"},6271(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-5b-86fcee25a08e557507f8228f7fa05ec2.png"},6309(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-29-a196656887952ad87e6b4e5a9e65df44.png"},6324(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-15-12103ff666d528ff1321e7037536273d.png"},6560(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-11-9d57771844a59ababf986745730cf9ea.png"},7128(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-19-e8faf29ba22d9a79909d25383d42aa30.png"},7133(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-21-13d38c4fc2c96d4cb09bfdb036e2cd9c.png"},7154(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-26-5116892344856fdb49594b620b707218.png"},7393(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-7b-5e9776b92e53b96b3cbbed107c38e815.png"},7453(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-14-0666801563454e01c15a76c17e65353d.png"},7507(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-9b-c16de3f4b1ddf04c97b1447881079405.png"},7756(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-8-3a59cb84ab565f110557482448c208e0.png"},7906(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-35-f8671854cf391cacf70d1fbb033bb719.png"},8453(e,n,i){i.d(n,{R:()=>l,x:()=>a});var s=i(6540);const r={},t=s.createContext(r);function l(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(t.Provider,{value:n},e.children)}},8665(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-10-1bd838186bb6ab22b197294f90a64fd8.png"},8699(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-27-e6435d1df60d3e24efee36bdd1a62402.png"},8783(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-16-be743e36f92db01123204996e3d4e962.png"},8896(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-4b-a88be5a3cdd5795b2f37d2b0748d32a3.png"},9030(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-2b-53fd22a6990bc3fb5eb96a354ab58b0d.png"},9124(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-33-10666e2c92cf98629be1daf9c11947c0.png"},9167(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-23-d5eddbb7ffb538ee6510027147b97038.png"},9306(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-3b-943d8e95f850796c637baf071fdebdaf.png"},9625(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/{59E12DA4-7ED5-4022-B5D0-80C9599A9D8A}-860b830a7a91b5f7f1b20a3a8e3a7550.png"},9841(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-18-804f3c5779aeb3e80bf66b283dfac88e.png"},9967(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-30-14dcd5f41046e7ed7e7e9684615620ca.png"},9979(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/image-1b-35ad28fddf815595270d3817cf64454f.png"}}]);